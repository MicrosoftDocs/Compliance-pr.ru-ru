---
title: Устойчивость данных SharePoint и OneDrive в Microsoft 365
description: В этой статье представлен обзор устойчивости данных SharePoint и OneDrive в Microsoft 365.
ms.author: robmazz
author: robmazz
manager: laurawi
ms.reviewer: sosstah
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
f1.keywords:
- NOCSH
ms.collection:
- Strat_O365_IP
- M365-security-compliance
- MS-Compliance
titleSuffix: Microsoft Service Assurance
ms.openlocfilehash: c940b778681805a1e50a9e565117cd67deb52566
ms.sourcegitcommit: 2973d25e9e0185b84d281f963553a332eac1c1a3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/28/2021
ms.locfileid: "50040389"
---
# <a name="sharepoint-and-onedrive-data-resiliency-in-microsoft-365"></a>Устойчивость данных SharePoint и OneDrive в Microsoft 365

В Microsoft 365 OneDrive построен на основе файловой платформы SharePoint. В этой статье для ссылок на оба продукта будет использоваться только SharePoint. Содержание этой статьи относится к Microsoft 365 и не относится к потребительским службам.

Существует два основных актива, которые составляют основное хранилище контента SharePoint:

- **Метаданные:** метаданные о каждом файле хранятся в azure SQL Database. Azure SQL предоставляет полную историю непрерывности бизнеса, которую Использует SharePoint, и подробные сведения будут подробно освещаются далее в этой статье.
- **Хранилище BLOB-приложений:** пользовательское содержимое, загруженное в SharePoint, хранится в хранилище Azure. SharePoint создал пользовательский план устойчивости на основе хранилища Azure, чтобы обеспечить дублирование пользовательского контента и действительно активной системы почти в режиме реального времени.

Полный набор элементов управления, обеспечивающих устойчивость данных, объясняется в последующих разделах.

## <a name="blob-storage-resilience"></a>Устойчивость хранилища BLOB-хранилищ

В SharePoint есть пользовательское решение для хранения данных клиентов в хранилище Azure. Каждый файл одновременно записан в основной и дополнительный регион центра обработки данных. Если в любой из областей Azure не удается сделать запись, сохранение файла не удастся. После записи содержимого в хранилище Azure контрольные контрольные точки хранятся отдельно с метаданными и используются для того, чтобы гарантировать, что зафиксированная запись идентична исходному файлу, отправленном в SharePoint во время всех последующих считывок. Этот же метод используется во всех рабочего процессах для предотвращения распространения любого повреждения, которое должно произойти. В каждом регионе azure Locally Redundant Storage (LRS) обеспечивает высокий уровень надежности. Подробные [сведения см. в статье](https://docs.microsoft.com/azure/storage/common/storage-redundancy-lrs) о резервированиях хранилища Azure.

SharePoint использует Append-Only хранилища. Этот процесс гарантирует, что файлы не могут быть изменены или повреждены после первоначального сохранения, но также с помощью версии продукта можно получить любую предыдущую версию содержимого файла.

Среды SharePoint в любом из центра обработки данных могут получать доступ к контейнерам хранилища в обоих регионах Azure. Из соображений производительности контейнер хранилища в том же локальном центре обработки данных всегда предпочтительный, однако запросы на чтение, которые не видят результатов в пределах нужного порога, будут иметь то же содержимое, которое запрашивается из удаленного центра обработки данных, чтобы гарантировать, что данные всегда доступны.

## <a name="metadata-resilience"></a>Устойчивость метаданных

Метаданные SharePoint также критически важны для доступа к пользовательскому содержимому, так как в них хранятся ключи доступа к содержимому, храняому в хранилище Azure. Эти базы данных хранятся в Azure SQL с обширным планом [непрерывности бизнеса.](https://docs.microsoft.com/azure/sql-database/sql-database-business-continuity)

SharePoint использует модель репликации, предоставляемую Azure SQL, и создал проприетарную технологию автоматизации, чтобы определить, требуется отбой и при необходимости инициировать операцию. Таким образом, она попадает в категорию "Отбой базы данных вручную" с точки SQL Azure. Последние показатели восстановления баз данных Azure SQL доступны [здесь.](https://docs.microsoft.com/azure/azure-sql/database/business-continuity-high-availability-disaster-recover-hadr-overview#recover-a-database-to-the-existing-server)

SharePoint использует систему SQL Azure для восстановления точки во времени (PITR) в течение 14 дней. PitR более подробно освещается в более [позднем разделе.](#deletion-backup-and-point-in-time-restore)

## <a name="automated-failover"></a>Автоматическая отбойная отбойная система

SharePoint использует настраиваемую автоматическую отбойную передачу, чтобы свести к минимуму влияние на клиентский опыт, когда происходит событие для конкретного расположения. Автоматизация на основе мониторинга, обнаруживаемая сбой одного или нескольких компонентов за пределами определенных пороговых значений, приведет к автоматическому перенаправлению всех действий пользователей из проблемной среды и перенаправлению на "теплый" дополнительный компонент. Отбой приводит к тому, что метаданные и вычислительные хранилища полностью обслуживаются из нового центра обработки данных. Так как хранилище BLOB всегда выполняется полностью активно или активно, для от сбоя не требуется никаких изменений. Вычислительный уровень предпочтит ближайший контейнер BLOB-объектов, но в любое время будет использовать как локальное, так и удаленное хранилище BLOB-объектов для обеспечения доступности.

SharePoint использует службу Azure Front Door для обеспечения внутренней маршрутки в сеть Майкрософт. Эта конфигурация позволяет перенаправлять отбой независимо от DNS и снижает влияние кэшации на локальном компьютере. Большинство операций от сбойов прозрачны для конечных пользователей. В случае сбойного решения пользователям не придется вносить какие-либо изменения, чтобы обеспечить доступ к службе.

## <a name="versioning-and-files-restore"></a>Восстановление версий и файлов

Для новых библиотек документов SharePoint по умолчанию содержит 500 версий для каждого файла и при желании может быть настроен на сохранение дополнительных версий. Пользовательский интерфейс не позволяет установить значение, меньшее чем 100 версий, но можно настроить систему для хранения меньше версий с помощью общедоступных API. Для обеспечения надежности любое значение меньше 100 не рекомендуется и может привести к непреднамеренной потере данных.

Дополнительные сведения о версии см. [в подпунктах "Версия" в SharePoint.](https://docs.microsoft.com/microsoft-365/community/versioning-basics-best-practices)

Восстановление файлов — это возможность вернуть время в любую библиотеку документов в SharePoint в любую секунду за последние 30 дней. Этот процесс можно использовать для восстановления после программ-вымогателей, массового удаления, повреждения или любого другого события. Эта функция использует версии файлов, поэтому уменьшение версий по умолчанию может снизить эффективность восстановления.

Функция восстановления файлов задокументирована как для [OneDrive,](https://support.office.com/article/restore-your-onedrive-fa231298-759d-41cf-bcd0-25ac53eb8a15) так и [для SharePoint.](https://support.office.com/article/Restore-a-document-library-317791c3-8bd0-4dfd-8254-3ca90883d39a)

## <a name="deletion-backup-and-point-in-time-restore"></a>Удаление, резервное копирование и восстановление точки во времени

Содержимое пользователя, удаленное из SharePoint, проходит через следующий поток удаления.

Удаленные элементы сохраняются в корзинах в течение определенного периода времени. Для SharePoint срок хранения составляет 93 дня. Он начинается с удаления элемента из его исходного расположения. При удалении элемента из корзины сайта он [](https://support.office.com/article/restore-deleted-items-from-the-site-collection-recycle-bin-5fa924ee-16d7-487b-9a0a-021b9062d14b)попадает в корзину. Он остается там в течение оставшихся 93 дней, а затем окончательно удаляется. Дополнительные сведения об использовании корзины можно найти по указанным здесь ссылкам.

- [Восстановление элементов в корзине](https://support.office.com/article/Restore-items-in-the-Recycle-Bin-of-a-SharePoint-site-6df466b6-55f2-4898-8d6e-c0dff851a0be)
- [Восстановление удаленных элементов из корзины для коллекции веб-сайтов.](https://support.office.com/article/Restore-deleted-items-from-the-site-collection-recycle-bin-5fa924ee-16d7-487b-9a0a-021b9062d14b)

Этот процесс является потоком удаления по умолчанию и не учитывает политики и метки хранения. Дополнительные сведения [см. в сведениях о хранении для SharePoint и OneDrive.](https://docs.microsoft.com/microsoft-365/compliance/retention-policies-sharepoint)

После завершения конвейера рециркуляции в течение 93 дней удаление происходит независимо для метаданных и хранилища BLOB-данных. Метаданные будут немедленно удалены из базы данных, что сделает содержимое нечитаемым, если метаданные не будут восстановлены из резервной копии. SharePoint поддерживает резервное копирование метаданных в течение 14 дней. Эти резервные копии принимаются локально почти в режиме реального времени, а затем в хранилище избыточных контейнеров хранилища [Azure,](https://docs.microsoft.com/azure/sql-database/sql-database-automated-backups) согласно документации на момент публикации, имеют 5-10-минутное расписание.

При удалении содержимого хранилища BLOB-элементов SharePoint использует функцию мягкого удаления для хранилища BLOB-элементов Azure, чтобы защититься от случайного или злонамеренного удаления. С помощью этой функции у нас есть в общей сложности 14 дней, в течение которых мы восстанавливаем содержимое до его без возможности восстановления.

>[!Note]
>Хотя приложения Майкрософт будут отправлять содержимое в корзину для стандартного процесса, SharePoint предоставляет API, позволяющие пропускать корзину и принудительно удалять ее немедленно. Просмотрите свои приложения, чтобы убедиться, что это делается только в случае необходимости в целях соответствия требованиям.

## <a name="integrity-checks"></a>Проверки целостности

SharePoint использует различные методы для обеспечения целостности больших и метаданных на всех этапах жизненного цикла данных:

- **Hash file stored in metadata**: Hash of the entire file is stored with file metadata to ensure document level data integrity is maintained during all operations
- **Hash BLOB,** хранимый в метаданных: каждый элемент BLOB-объект хранит hash зашифрованного содержимого для защиты от повреждения в основном хранилище Azure.
- **Задание целостности** данных: каждые 14 дней каждый сайт проверяется на целостность, перечисляя элементы в базе данных и соединая с перечисленными BLOB-объектами в хранилище Azure. Задание сообщает о любых ссылках на BLOB-файлы и при необходимости может получить эти [BLOB-файлы](https://docs.microsoft.com/azure/storage/blobs/soft-delete-blob-overview) с помощью функции мягкого удаления хранилища Azure.
